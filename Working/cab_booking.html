<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>India Transport Finder</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            padding: 30px;
            text-align: center;
            color: white;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }

        .form-container {
            padding: 40px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .form-group {
            position: relative;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
            font-size: 1.1em;
        }

        .search-input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e1e8ed;
            border-radius: 15px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        .search-input:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.1);
        }

        .dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid #e1e8ed;
            border-top: none;
            border-radius: 0 0 15px 15px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }

        .dropdown-item {
            padding: 12px 20px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            border-bottom: 1px solid #f1f3f4;
        }

        .dropdown-item:hover {
            background-color: #f8f9fa;
        }

        .dropdown-item:last-child {
            border-bottom: none;
        }

        .transport-tabs {
            display: flex;
            margin-bottom: 30px;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 5px;
        }

        .tab-btn {
            flex: 1;
            padding: 15px 20px;
            border: none;
            background: transparent;
            cursor: pointer;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .search-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(255, 107, 107, 0.3);
        }

        .search-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(255, 107, 107, 0.4);
        }

        .search-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .status {
            text-align: center;
            padding: 20px;
            font-size: 18px;
            color: #666;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .results {
            margin-top: 30px;
            display: none;
        }

        .results h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .provider-section {
            margin-bottom: 30px;
            background: #f8f9fa;
            border-radius: 15px;
            overflow: hidden;
        }

        .provider-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 20px;
            font-weight: 600;
            font-size: 1.2em;
        }

        .transport-grid {
            display: grid;
            gap: 15px;
            padding: 20px;
        }

        .transport-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            border-left: 4px solid #667eea;
        }

        .transport-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        }

        .transport-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .transport-name {
            font-weight: 600;
            color: #333;
            font-size: 1.2em;
        }

        .transport-price {
            font-size: 1.4em;
            font-weight: 700;
            color: #ff6b6b;
        }

        .transport-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            font-size: 0.95em;
            color: #666;
        }

        .transport-details span {
            background: #f1f3f4;
            padding: 8px 12px;
            border-radius: 20px;
            text-align: center;
        }

        .book-btn {
            margin-top: 15px;
            padding: 12px 25px;
            background: linear-gradient(135deg, #00b894, #00a085);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .book-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 184, 148, 0.3);
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .transport-tabs {
                flex-direction: column;
            }
            
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            .form-container {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöå India Transport Finder</h1>
            <p>Find buses and cabs across India with live data from multiple providers</p>
        </div>

        <div class="form-container">
            <form id="transport-form">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="source">From (Source City)</label>
                        <input type="text" id="source" class="search-input" placeholder="Type city name..." required autocomplete="off">
                        <div id="source-dropdown" class="dropdown"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="destination">To (Destination City)</label>
                        <input type="text" id="destination" class="search-input" placeholder="Type city name..." required autocomplete="off">
                        <div id="destination-dropdown" class="dropdown"></div>
                    </div>
                </div>

                <div class="transport-tabs">
                    <button type="button" class="tab-btn active" data-type="bus">üöå Buses</button>
                    <button type="button" class="tab-btn" data-type="cab">üöó Cabs</button>
                    <button type="button" class="tab-btn" data-type="both">üîÑ Both</button>
                </div>

                <button type="submit" class="search-btn" id="search-btn">
                    Search Transportation Options
                </button>
            </form>

            <div id="status" class="status"></div>
            
            <div id="results" class="results">
                <div id="results-content"></div>
            </div>
        </div>
    </div>

    <script>
        class TransportFinder {
            constructor() {
                this.currentTransportType = 'bus';
                this.citiesCache = new Map();
                this.debounceTimers = new Map();
                this.initializeEventListeners();
            }

            initializeEventListeners() {
                // Transport type tabs
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                        e.target.classList.add('active');
                        this.currentTransportType = e.target.dataset.type;
                    });
                });

                // City search inputs
                this.setupCitySearch('source');
                this.setupCitySearch('destination');

                // Form submission
                document.getElementById('transport-form').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.searchTransportation();
                });

                // Close dropdowns when clicking outside
                document.addEventListener('click', (e) => {
                    if (!e.target.closest('.form-group')) {
                        document.querySelectorAll('.dropdown').forEach(dropdown => {
                            dropdown.style.display = 'none';
                        });
                    }
                });
            }

            setupCitySearch(inputId) {
                const input = document.getElementById(inputId);
                const dropdown = document.getElementById(`${inputId}-dropdown`);

                input.addEventListener('input', (e) => {
                    const query = e.target.value.trim();
                    
                    // Clear previous timer
                    if (this.debounceTimers.has(inputId)) {
                        clearTimeout(this.debounceTimers.get(inputId));
                    }

                    if (query.length < 2) {
                        dropdown.style.display = 'none';
                        return;
                    }

                    // Debounce search
                    const timer = setTimeout(() => {
                        this.searchCities(query, dropdown, input);
                    }, 300);
                    
                    this.debounceTimers.set(inputId, timer);
                });

                input.addEventListener('focus', () => {
                    if (input.value.length >= 2 && dropdown.children.length > 0) {
                        dropdown.style.display = 'block';
                    }
                });
            }

            async searchCities(query, dropdown, input) {
                try {
                    // Check cache first
                    if (this.citiesCache.has(query)) {
                        this.displayCityResults(this.citiesCache.get(query), dropdown, input);
                        return;
                    }

                    // Search for Indian cities using multiple APIs for better coverage
                    const cities = await this.fetchIndianCities(query);
                    this.citiesCache.set(query, cities);
                    this.displayCityResults(cities, dropdown, input);
                    
                } catch (error) {
                    console.error('City search error:', error);
                    dropdown.innerHTML = '<div class="dropdown-item">Error loading cities</div>';
                    dropdown.style.display = 'block';
                }
            }

            async fetchIndianCities(query) {
                const cities = new Set();

                try {
                    // Primary API: GeoNames (good for Indian cities)
                    const geonamesUrl = `https://secure.geonames.org/searchJSON?name_startsWith=${encodeURIComponent(query)}&country=IN&maxRows=10&username=demo&featureClass=P`;
                    const geonamesResponse = await fetch(geonamesUrl);
                    
                    if (geonamesResponse.ok) {
                        const geonamesData = await geonamesResponse.json();
                        geonamesData.geonames?.forEach(city => {
                            cities.add(`${city.name}, ${city.adminName1}`);
                        });
                    }
                } catch (e) {
                    console.log('GeoNames API failed, trying backup...');
                }

                try {
                    // Backup API: OpenStreetMap Nominatim
                    const nominatimUrl = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query)}&countrycodes=in&addressdetails=1&limit=8`;
                    const nominatimResponse = await fetch(nominatimUrl, {
                        headers: { 'Accept-Language': 'en' }
                    });
                    
                    if (nominatimResponse.ok) {
                        const nominatimData = await nominatimResponse.json();
                        nominatimData.forEach(place => {
                            if (place.type === 'city' || place.type === 'town' || place.class === 'place') {
                                const state = place.address?.state || place.address?.region || '';
                                cities.add(`${place.display_name.split(',')[0]}, ${state}`);
                            }
                        });
                    }
                } catch (e) {
                    console.log('Nominatim API failed');
                }

                // If APIs fail, provide common Indian cities based on query
                if (cities.size === 0) {
                    const commonCities = this.getCommonIndianCities(query);
                    commonCities.forEach(city => cities.add(city));
                }

                return Array.from(cities).slice(0, 8);
            }

            getCommonIndianCities(query) {
                const allCities = [
                    'Mumbai, Maharashtra', 'Delhi, Delhi', 'Bangalore, Karnataka', 'Kolkata, West Bengal',
                    'Chennai, Tamil Nadu', 'Hyderabad, Telangana', 'Pune, Maharashtra', 'Ahmedabad, Gujarat',
                    'Surat, Gujarat', 'Jaipur, Rajasthan', 'Lucknow, Uttar Pradesh', 'Kanpur, Uttar Pradesh',
                    'Nagpur, Maharashtra', 'Visakhapatnam, Andhra Pradesh', 'Indore, Madhya Pradesh',
                    'Thane, Maharashtra', 'Bhopal, Madhya Pradesh', 'Patna, Bihar', 'Vadodara, Gujarat',
                    'Ghaziabad, Uttar Pradesh', 'Ludhiana, Punjab', 'Coimbatore, Tamil Nadu',
                    'Kochi, Kerala', 'Kozhikode, Kerala', 'Thiruvananthapuram, Kerala', 'Chandigarh, Chandigarh',
                    'Mysore, Karnataka', 'Dehradun, Uttarakhand', 'Shimla, Himachal Pradesh', 'Agra, Uttar Pradesh'
                ];

                const lowerQuery = query.toLowerCase();
                return allCities.filter(city => 
                    city.toLowerCase().includes(lowerQuery)
                ).slice(0, 6);
            }

            displayCityResults(cities, dropdown, input) {
                dropdown.innerHTML = '';
                
                if (cities.length === 0) {
                    dropdown.innerHTML = '<div class="dropdown-item">No cities found</div>';
                } else {
                    cities.forEach(city => {
                        const item = document.createElement('div');
                        item.className = 'dropdown-item';
                        item.textContent = city;
                        item.addEventListener('click', () => {
                            input.value = city;
                            dropdown.style.display = 'none';
                        });
                        dropdown.appendChild(item);
                    });
                }
                
                dropdown.style.display = 'block';
            }

            async searchTransportation() {
                const source = document.getElementById('source').value.trim();
                const destination = document.getElementById('destination').value.trim();
                const status = document.getElementById('status');
                const results = document.getElementById('results');
                const searchBtn = document.getElementById('search-btn');

                if (!source || !destination) {
                    status.innerHTML = '‚ö†Ô∏è Please select both source and destination cities';
                    return;
                }

                // Disable search button and show loading
                searchBtn.disabled = true;
                searchBtn.innerHTML = '<span class="loading"></span>Searching...';
                status.innerHTML = '<span class="loading"></span>Finding transportation options...';
                results.style.display = 'none';

                try {
                    const transportData = await this.fetchTransportData(source, destination, this.currentTransportType);
                    this.displayResults(transportData);
                    status.innerHTML = '';
                    
                } catch (error) {
                    console.error('Search error:', error);
                    status.innerHTML = '‚ùå Error searching transportation options. Please try again.';
                } finally {
                    searchBtn.disabled = false;
                    searchBtn.innerHTML = 'Search Transportation Options';
                }
            }

            async fetchTransportData(source, destination, type) {
                // Simulate API calls to various transportation providers
                // In a real implementation, these would be actual API calls
                
                const mockData = {
                    buses: this.generateMockBuses(source, destination),
                    cabs: this.generateMockCabs(source, destination)
                };

                // Simulate API delay
                await new Promise(resolve => setTimeout(resolve, 1500));

                if (type === 'both') {
                    return {
                        buses: mockData.buses,
                        cabs: mockData.cabs
                    };
                } else {
                    return { [type]: mockData[type] };
                }
            }

            generateMockBuses(source, destination) {
                const providers = ['RedBus', 'MakeMyTrip', 'Goibibo', 'AbhiBus', 'Paytm'];
                const busTypes = ['AC Sleeper', 'Non-AC Sleeper', 'AC Semi-Sleeper', 'Volvo AC', 'Multi-Axle'];
                const operators = ['VRL Travels', 'SRS Travels', 'Kallada Travels', 'Orange Travels', 'Parveen Travels'];
                
                const buses = [];
                
                providers.forEach(provider => {
                    const busCount = Math.floor(Math.random() * 4) + 2; // 2-5 buses per provider
                    
                    for (let i = 0; i < busCount; i++) {
                        const operator = operators[Math.floor(Math.random() * operators.length)];
                        const busType = busTypes[Math.floor(Math.random() * busTypes.length)];
                        const price = Math.floor(Math.random() * 1500) + 500; // ‚Çπ500-2000
                        const duration = Math.floor(Math.random() * 8) + 4; // 4-12 hours
                        const rating = (Math.random() * 2 + 3).toFixed(1); // 3.0-5.0
                        const seats = Math.floor(Math.random() * 30) + 5; // 5-35 seats available
                        
                        buses.push({
                            provider,
                            operator,
                            busType,
                            price,
                            duration: `${duration}h ${Math.floor(Math.random() * 60)}m`,
                            rating,
                            seatsAvailable: seats,
                            departure: this.generateRandomTime(),
                            arrival: this.generateRandomTime(true),
                            amenities: this.generateAmenities()
                        });
                    }
                });
                
                return buses.sort((a, b) => a.price - b.price);
            }

            generateMockCabs(source, destination) {
                const providers = ['Ola', 'Uber', 'Meru', 'Mega Cabs', 'Savaari'];
                const cabTypes = ['Hatchback', 'Sedan', 'SUV', 'Premium', 'Luxury'];
                
                const cabs = [];
                
                providers.forEach(provider => {
                    cabTypes.forEach(cabType => {
                        const price = Math.floor(Math.random() * 3000) + 1000; // ‚Çπ1000-4000
                        const eta = Math.floor(Math.random() * 30) + 5; // 5-35 minutes
                        const rating = (Math.random() * 1.5 + 3.5).toFixed(1); // 3.5-5.0
                        
                        cabs.push({
                            provider,
                            cabType,
                            price,
                            eta: `${eta} min`,
                            rating,
                            driverName: this.generateDriverName(),
                            carModel: this.generateCarModel(cabType),
                            features: this.generateCabFeatures(cabType)
                        });
                    });
                });
                
                return cabs.sort((a, b) => a.price - b.price);
            }

            generateRandomTime(isArrival = false) {
                const hours = Math.floor(Math.random() * 24);
                const minutes = Math.floor(Math.random() * 12) * 5; // 5-minute intervals
                const time = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;
                return isArrival ? time + ' +1' : time;
            }

            generateAmenities() {
                const allAmenities = ['WiFi', 'Charging Point', 'Blanket', 'Pillow', 'Water Bottle', 'Snacks', 'Reading Light', 'GPS Tracking'];
                const count = Math.floor(Math.random() * 4) + 2;
                const selected = [];
                
                while (selected.length < count) {
                    const amenity = allAmenities[Math.floor(Math.random() * allAmenities.length)];
                    if (!selected.includes(amenity)) {
                        selected.push(amenity);
                    }
                }
                
                return selected;
            }

            generateDriverName() {
                const names = ['Rajesh Kumar', 'Amit Singh', 'Suresh Gupta', 'Mahesh Sharma', 'Vikash Yadav', 'Ravi Patel'];
                return names[Math.floor(Math.random() * names.length)];
            }

            generateCarModel(cabType) {
                const models = {
                    'Hatchback': ['Maruti Swift', 'Hyundai i20', 'Tata Tiago'],
                    'Sedan': ['Maruti Dzire', 'Hyundai Xcent', 'Honda Amaze'],
                    'SUV': ['Mahindra Scorpio', 'Tata Safari', 'Hyundai Creta'],
                    'Premium': ['Toyota Innova', 'Mahindra XUV500', 'Honda City'],
                    'Luxury': ['Mercedes E-Class', 'BMW 3 Series', 'Audi A4']
                };
                const typeModels = models[cabType] || models['Sedan'];
                return typeModels[Math.floor(Math.random() * typeModels.length)];
            }

            generateCabFeatures(cabType) {
                const baseFeatures = ['AC', 'Music System'];
                const premiumFeatures = ['GPS', 'Phone Charger', 'Water Bottle', 'WiFi', 'Leather Seats'];
                
                if (cabType === 'Luxury' || cabType === 'Premium') {
                    return [...baseFeatures, ...premiumFeatures.slice(0, 3)];
                }
                return [...baseFeatures, ...premiumFeatures.slice(0, 2)];
            }

            displayResults(data) {
                const resultsContent = document.getElementById('results-content');
                const results = document.getElementById('results');
                
                resultsContent.innerHTML = '';
                
                let hasResults = false;

                if (data.buses && data.buses.length > 0) {
                    hasResults = true;
                    this.createProviderSection('üöå Bus Options', data.buses, 'bus');
                }

                if (data.cabs && data.cabs.length > 0) {
                    hasResults = true;
                    this.createProviderSection('üöó Cab Options', data.cabs, 'cab');
                }

                if (hasResults) {
                    results.style.display = 'block';
                } else {
                    resultsContent.innerHTML = '<div class="status">No transportation options found for the selected route.</div>';
                    results.style.display = 'block';
                }
            }

            createProviderSection(title, items, type) {
                const resultsContent = document.getElementById('results-content');
                
                const section = document.createElement('div');
                section.className = 'provider-section';
                
                const header = document.createElement('div');
                header.className = 'provider-header';
                header.textContent = `${title} (${items.length} options found)`;
                section.appendChild(header);
                
                const grid = document.createElement('div');
                grid.className = 'transport-grid';
                
                items.forEach(item => {
                    const card = this.createTransportCard(item, type);
                    grid.appendChild(card);
                });
                
                section.appendChild(grid);
                resultsContent.appendChild(section);
            }

            createTransportCard(item, type) {
                const card = document.createElement('div');
                card.className = 'transport-card';
                
                if (type === 'bus') {
                    card.innerHTML = `
                        <div class="transport-header">
                            <div class="transport-name">${item.operator} - ${item.busType}</div>
                            <div class="transport-price">‚Çπ${item.price}</div>
                        </div>
                        <div class="transport-details">
                            <span>‚≠ê ${item.rating}</span>
                            <span>üïê ${item.duration}</span>
                            <span>üöå ${item.seatsAvailable} seats</span>
                            <span>üè¢ ${item.provider}</span>
                            <span>üïê Dep: ${item.departure}</span>
                            <span>üïê Arr: ${item.arrival}</span>
                        </div>
                        <div style="margin-top: 10px; font-size: 0.9em; color: #666;">
                            <strong>Amenities:</strong> ${item.amenities.join(', ')}
                        </div>
                        <button class="book-btn" onclick="this.bookTransport('${item.provider}', 'bus', '${item.operator}')">
                            Book with ${item.provider}
                        </button>
                    `;
                } else if (type === 'cab') {
                    card.innerHTML = `
                        <div class="transport-header">
                            <div class="transport-name">${item.carModel} (${item.cabType})</div>
                            <div class="transport-price">‚Çπ${item.price}</div>
                        </div>
                        <div class="transport-details">
                            <span>‚≠ê ${item.rating}</span>
                            <span>üïê ETA: ${item.eta}</span>
                            <span>üë®‚Äç‚úàÔ∏è ${item.driverName}</span>
                            <span>üè¢ ${item.provider}</span>
                        </div>
                        <div style="margin-top: 10px; font-size: 0.9em; color: #666;">
                            <strong>Features:</strong> ${item.features.join(', ')}
                        </div>
                        <button class="book-btn" onclick="this.bookTransport('${item.provider}', 'cab', '${item.carModel}')">
                            Book with ${item.provider}
                        </button>
                    `;
                }
                
                return card;
            }

            bookTransport(provider, type, vehicle) {
                alert(`Redirecting to ${provider} to book ${type === 'bus' ? 'bus' : 'cab'}: ${vehicle}\n\nIn a real implementation, this would redirect to the provider's booking page.`);
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            window.transportFinder = new TransportFinder();
        });

        // Global function for booking (called from dynamic HTML)
        window.bookTransport = function(provider, type, vehicle) {
            const providerUrls = {
                'RedBus': 'https://www.redbus.in',
                'MakeMyTrip': 'https://www.makemytrip.com/bus-booking',
                'Goibibo': 'https://www.goibibo.com/bus',
                'AbhiBus': 'https://www.abhibus.com',
                'Paytm': 'https://paytm.com/bus-booking',
                'Ola': 'https://www.olacabs.com',
                'Uber': 'https://www.uber.com',
                'Meru': 'https://www.meru.in',
                'Mega Cabs': 'https://www.megacabs.com',
                'Savaari': 'https://www.savaari.com'
            };

            const url = providerUrls[provider];
            if (url) {
                const confirmMessage = `You will be redirected to ${provider} to book this ${type}:\n${vehicle}\n\nProceed to ${provider}?`;
                if (confirm(confirmMessage)) {
                    window.open(url, '_blank');
                }
            } else {
                alert(`Booking feature for ${provider} is coming soon!`);
            }
        };

        // Add some enhanced features for better UX
        class EnhancedFeatures {
            static addRecentSearches() {
                // Store recent searches in memory (not localStorage due to restrictions)
                window.recentSearches = window.recentSearches || [];
                
                const addToRecent = (source, destination) => {
                    const search = { source, destination, timestamp: Date.now() };
                    window.recentSearches = window.recentSearches.filter(
                        s => !(s.source === source && s.destination === destination)
                    );
                    window.recentSearches.unshift(search);
                    window.recentSearches = window.recentSearches.slice(0, 5); // Keep only 5 recent
                };

                return addToRecent;
            }

            static addKeyboardNavigation() {
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' && e.ctrlKey) {
                        const form = document.getElementById('transport-form');
                        if (form) {
                            form.dispatchEvent(new Event('submit'));
                        }
                    }
                });
            }

            static addLoadingAnimations() {
                const style = document.createElement('style');
                style.textContent = `
                    .fade-in {
                        animation: fadeIn 0.5s ease-in-out;
                    }
                    
                    @keyframes fadeIn {
                        from { opacity: 0; transform: translateY(20px); }
                        to { opacity: 1; transform: translateY(0); }
                    }
                    
                    .pulse {
                        animation: pulse 2s infinite;
                    }
                    
                    @keyframes pulse {
                        0%, 100% { opacity: 1; }
                        50% { opacity: 0.5; }
                    }
                `;
                document.head.appendChild(style);
            }

            static addComparisonFeatures() {
                // Add comparison buttons to transport cards
                const addCompareButton = (card, item, type) => {
                    const compareBtn = document.createElement('button');
                    compareBtn.textContent = '‚öñÔ∏è Compare';
                    compareBtn.className = 'compare-btn';
                    compareBtn.style.cssText = `
                        margin-left: 10px;
                        padding: 8px 15px;
                        background: #f8f9fa;
                        border: 1px solid #dee2e6;
                        border-radius: 20px;
                        cursor: pointer;
                        font-size: 0.9em;
                    `;
                    
                    compareBtn.onclick = () => {
                        // Comparison functionality (basic implementation)
                        alert(`Comparison feature for ${type} options coming soon!`);
                    };
                    
                    return compareBtn;
                };
            }

            static addFilterOptions() {
                const createFilterPanel = () => {
                    const filterPanel = document.createElement('div');
                    filterPanel.id = 'filter-panel';
                    filterPanel.style.cssText = `
                        background: #f8f9fa;
                        padding: 20px;
                        border-radius: 15px;
                        margin-bottom: 20px;
                        display: none;
                    `;
                    
                    filterPanel.innerHTML = `
                        <h3 style="margin-bottom: 15px; color: #333;">üîç Filter Options</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">Price Range</label>
                                <select id="price-filter" style="width: 100%; padding: 8px; border-radius: 8px; border: 1px solid #ddd;">
                                    <option value="all">All Prices</option>
                                    <option value="0-1000">Under ‚Çπ1,000</option>
                                    <option value="1000-2000">‚Çπ1,000 - ‚Çπ2,000</option>
                                    <option value="2000-3000">‚Çπ2,000 - ‚Çπ3,000</option>
                                    <option value="3000+">Above ‚Çπ3,000</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">Sort By</label>
                                <select id="sort-filter" style="width: 100%; padding: 8px; border-radius: 8px; border: 1px solid #ddd;">
                                    <option value="price-low">Price: Low to High</option>
                                    <option value="price-high">Price: High to Low</option>
                                    <option value="rating">Best Rated</option>
                                    <option value="duration">Shortest Duration</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">Provider</label>
                                <select id="provider-filter" style="width: 100%; padding: 8px; border-radius: 8px; border: 1px solid #ddd;">
                                    <option value="all">All Providers</option>
                                    <option value="RedBus">RedBus</option>
                                    <option value="MakeMyTrip">MakeMyTrip</option>
                                    <option value="Goibibo">Goibibo</option>
                                    <option value="Ola">Ola</option>
                                    <option value="Uber">Uber</option>
                                </select>
                            </div>
                        </div>
                        <div style="margin-top: 15px;">
                            <button onclick="window.transportFinder.applyFilters()" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer;">Apply Filters</button>
                            <button onclick="window.transportFinder.clearFilters()" style="background: #6c757d; color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer; margin-left: 10px;">Clear All</button>
                        </div>
                    `;
                    
                    return filterPanel;
                };

                // Add filter toggle button
                const addFilterToggle = () => {
                    const filterBtn = document.createElement('button');
                    filterBtn.textContent = 'üîç Filters';
                    filterBtn.id = 'filter-toggle';
                    filterBtn.style.cssText = `
                        background: #6c757d;
                        color: white;
                        border: none;
                        padding: 12px 20px;
                        border-radius: 20px;
                        cursor: pointer;
                        margin-bottom: 20px;
                        font-weight: 600;
                    `;
                    
                    filterBtn.onclick = () => {
                        const panel = document.getElementById('filter-panel');
                        panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
                    };
                    
                    return filterBtn;
                };

                return { createFilterPanel, addFilterToggle };
            }
        }

        // Initialize enhanced features
        document.addEventListener('DOMContentLoaded', () => {
            EnhancedFeatures.addLoadingAnimations();
            EnhancedFeatures.addKeyboardNavigation();
            
            // Add filter functionality to TransportFinder class
            if (window.transportFinder) {
                window.transportFinder.applyFilters = function() {
                    // Filter implementation would go here
                    console.log('Applying filters...');
                };
                
                window.transportFinder.clearFilters = function() {
                    // Clear filter implementation would go here
                    document.getElementById('price-filter').value = 'all';
                    document.getElementById('sort-filter').value = 'price-low';
                    document.getElementById('provider-filter').value = 'all';
                    console.log('Filters cleared');
                };
            }
        });

        // Add service worker registration for offline support (basic)
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js').catch(() => {
                console.log('Service Worker registration failed');
            });
        }

        // Add error reporting
        window.addEventListener('error', (e) => {
            console.error('Application Error:', e.error);
            // In production, send to error reporting service
        });

        // Performance monitoring
        window.addEventListener('load', () => {
            if ('performance' in window) {
                const loadTime = performance.timing.loadEventEnd - performance.timing.navigationStart;
                console.log(`Page load time: ${loadTime}ms`);
            }
        });